@using Microsoft.AspNetCore.Components
@inject IJSRuntime JSRuntime

<div id="splash-screen" class="splash-container">
    <div class="splash-content">
        <!-- Logo/Brand Section -->
        <div class="splash-logo">
            <div class="logo-container">
                <!-- BinFlow Logo SVG -->
                <div class="binflow-logo">
                    <!-- Top shapes -->
                    <div class="logo-shape shape-1"></div>
                    <div class="logo-shape shape-2"></div>
                    <!-- Bottom shapes -->
                    <div class="logo-shape shape-3"></div>
                    <div class="logo-shape shape-4"></div>
                </div>
                <div class="logo-text-container">
                    <h1 class="brand-text">
                        <span class="bin-text">Bin</span><span class="flow-text">Flow</span>
                    </h1>
                </div>
            </div>
            <p class="splash-subtitle">A SoftFlair Product</p>
        </div>
        
        <!-- Modern Loading Animation -->
        <div class="loading-section">
            <div class="circular-spinner">
                <div class="spinner-circle"></div>
            </div>
            <p class="loading-text">Initializing...</p>
        </div>
        
        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-bar" id="splash-progress"></div>
        </div>
    </div>
</div>

<script>
    // Use a global flag to ensure splash only shows once per session
    if (typeof window.binflowSplashShown === 'undefined') {
        window.binflowSplashShown = sessionStorage.getItem('binflowSplashShown') === 'true';
    }
    
    if (!window.binflowSplashShown) {
        // First time in session - show splash
        window.binflowSplashShown = true;
        sessionStorage.setItem('binflowSplashShown', 'true');
        
        setTimeout(function() {
            var splash = document.getElementById('splash-screen');
            if (splash) {
                splash.style.display = 'none';
            }
        }, 1500);
    } else {
        // Already shown - hide immediately
        var splash = document.getElementById('splash-screen');
        if (splash) {
            splash.style.display = 'none';
        }
    }
</script>

<style>
    .splash-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: linear-gradient(135deg, var(--secondary-color) 0%, #1a2b33 50%, var(--accent-color) 100%);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        opacity: 1;
        transition: opacity 0.5s ease-out, visibility 0.5s ease-out;
    }
    
    .splash-container.fade-out {
        opacity: 0;
        visibility: hidden;
    }
    
    .splash-content {
        text-align: center;
        color: white;
        animation: slideInUp 1s ease-out;
    }
    
    .splash-logo {
        margin-bottom: 3rem;
    }
    
    .logo-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-bottom: 1.5rem;
    }
    
    .binflow-logo {
        position: relative;
        width: 120px;
        height: 120px;
        margin-bottom: 1rem;
        animation: logoFloat 3s ease-in-out infinite;
    }
    
    .logo-shape {
        position: absolute;
        border-radius: 20px;
        animation: shapeFloat 4s ease-in-out infinite;
    }
    
    /* Top left - Green */
    .shape-1 {
        top: 0;
        left: 0;
        width: 50px;
        height: 50px;
        background: linear-gradient(135deg, #00d084, #00b574);
        border-top-left-radius: 25px;
        border-top-right-radius: 8px;
        border-bottom-left-radius: 8px;
        border-bottom-right-radius: 25px;
        animation-delay: 0s;
        box-shadow: 0 4px 15px rgba(0, 208, 132, 0.3);
    }
    
    /* Top right - Gray */
    .shape-2 {
        top: 0;
        right: 0;
        width: 60px;
        height: 60px;
        background: linear-gradient(135deg, #8b8b8b, #606060);
        border-top-left-radius: 8px;
        border-top-right-radius: 30px;
        border-bottom-left-radius: 30px;
        border-bottom-right-radius: 8px;
        animation-delay: 0.5s;
        box-shadow: 0 4px 15px rgba(139, 139, 139, 0.3);
    }
    
    /* Bottom left - Gray */
    .shape-3 {
        bottom: 0;
        left: 0;
        width: 60px;
        height: 60px;
        background: linear-gradient(135deg, #606060, #404040);
        border-top-left-radius: 30px;
        border-top-right-radius: 8px;
        border-bottom-left-radius: 8px;
        border-bottom-right-radius: 30px;
        animation-delay: 1s;
        box-shadow: 0 4px 15px rgba(96, 96, 96, 0.3);
    }
    
    /* Bottom right - Green */
    .shape-4 {
        bottom: 0;
        right: 0;
        width: 50px;
        height: 50px;
        background: linear-gradient(135deg, #00b574, #009a63);
        border-top-left-radius: 25px;
        border-top-right-radius: 8px;
        border-bottom-left-radius: 8px;
        border-bottom-right-radius: 25px;
        animation-delay: 1.5s;
        box-shadow: 0 4px 15px rgba(0, 181, 116, 0.3);
    }
    
    .logo-text-container {
        text-align: center;
    }
    
    .brand-text {
        font-size: 3rem;
        font-weight: 900;
        margin: 0;
        letter-spacing: -2px;
        animation: textGlow 2s ease-in-out infinite alternate;
    }
    
    .bin-text {
        color: #ffffff;
        text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
    }
    
    .flow-text {
        color: #00d084;
        text-shadow: 0 0 20px rgba(0, 208, 132, 0.5);
    }
    
    .logo-circle {
        width: 140px;
        height: 140px;
        border-radius: 30px;
        background: linear-gradient(145deg, var(--accent-color), #e6a54a);
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 0 auto 1.5rem;
        position: relative;
        animation: logoFloat 3s ease-in-out infinite;
        box-shadow: 
            0 0 40px rgba(216, 151, 60, 0.4),
            inset 0 0 0 2px rgba(255,255,255,0.1);
        overflow: hidden;
    }
    
    .hexagon-pattern {
        position: absolute;
        width: 100%;
        height: 100%;
        opacity: 0.2;
    }
    
    .hex {
        position: absolute;
        width: 20px;
        height: 20px;
        background: white;
        transform: rotate(45deg);
        animation: hexFloat 4s ease-in-out infinite;
    }
    
    .hex-1 { top: 20%; left: 20%; animation-delay: 0s; }
    .hex-2 { top: 30%; right: 25%; animation-delay: 0.5s; }
    .hex-3 { bottom: 35%; left: 25%; animation-delay: 1s; }
    .hex-4 { bottom: 25%; right: 20%; animation-delay: 1.5s; }
    .hex-5 { top: 50%; left: 10%; animation-delay: 2s; }
    .hex-6 { top: 40%; right: 15%; animation-delay: 2.5s; }
    
    .logo-text {
        font-size: 2.5rem;
        font-weight: 900;
        color: white;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        z-index: 2;
        letter-spacing: -2px;
    }
    
    .logo-icon {
        font-size: 3.5rem;
        color: white;
        animation: rotate 3s linear infinite;
    }
    
    .splash-title {
        font-size: 2.5rem;
        font-weight: 700;
        margin: 0 0 0.5rem 0;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        animation: fadeInScale 1.2s ease-out 0.3s both;
    }
    
    .splash-subtitle {
        font-size: 1.1rem;
        opacity: 0.9;
        margin: 0 0 2rem 0;
        animation: fadeIn 1.5s ease-out 0.6s both;
        color: rgba(255, 255, 255, 0.8);
        font-weight: 300;
    }
    
    .loading-section {
        margin-bottom: 2rem;
    }
    
    .circular-spinner {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 40px;
        margin-bottom: 1rem;
    }
    
    .spinner-circle {
        width: 40px;
        height: 40px;
        border: 3px solid rgba(255, 255, 255, 0.2);
        border-top: 3px solid var(--accent-color);
        border-radius: 50%;
        animation: circularSpin 1s linear infinite;
    }
    
    .modern-loader {
        display: flex;
        justify-content: center;
        align-items: flex-end;
        gap: 4px;
        height: 40px;
        margin-bottom: 1rem;
    }
    
    .loader-bar {
        width: 6px;
        background: linear-gradient(to top, var(--accent-color), #ffffff);
        border-radius: 3px;
        animation: modernPulse 1.5s ease-in-out infinite;
    }
    
    .bar-1 { animation-delay: 0s; }
    .bar-2 { animation-delay: 0.1s; }
    .bar-3 { animation-delay: 0.2s; }
    .bar-4 { animation-delay: 0.3s; }
    .bar-5 { animation-delay: 0.4s; }
    
    .loading-spinner {
        display: flex;
        justify-content: center;
        gap: 0.5rem;
        margin-bottom: 1rem;
    }
    
    .spinner-ring {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: var(--accent-color);
        animation: bounce 1.4s ease-in-out infinite both;
    }
    
    .spinner-ring:nth-child(2) {
        animation-delay: 0.16s;
    }
    
    .spinner-ring:nth-child(3) {
        animation-delay: 0.32s;
    }
    
    .loading-text {
        font-size: 1rem;
        opacity: 0.8;
        margin: 0;
        animation: pulse 2s infinite;
    }
    
    .progress-container {
        width: 300px;
        height: 4px;
        background: rgba(255,255,255,0.2);
        border-radius: 2px;
        margin: 0 auto;
        overflow: hidden;
    }
    
    .progress-bar {
        height: 100%;
        background: linear-gradient(90deg, var(--accent-color), #e6a54a);
        border-radius: 2px;
        width: 0%;
        animation: progressLoad 2.5s ease-out forwards;
    }
    
    /* Animations */
    @@keyframes logoFloat {
        0%, 100% {
            transform: translateY(0px);
        }
        50% {
            transform: translateY(-8px);
        }
    }
    
    @@keyframes shapeFloat {
        0%, 100% {
            transform: translateY(0px) scale(1);
        }
        25% {
            transform: translateY(-3px) scale(1.02);
        }
        75% {
            transform: translateY(3px) scale(0.98);
        }
    }
    
    @@keyframes textGlow {
        0% {
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.3), 0 0 20px rgba(0, 208, 132, 0.2);
        }
        100% {
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.6), 0 0 30px rgba(0, 208, 132, 0.4);
        }
    }
    
    @@keyframes hexFloat {
        0%, 100% {
            transform: rotate(45deg) scale(0.8);
            opacity: 0.1;
        }
        50% {
            transform: rotate(225deg) scale(1.2);
            opacity: 0.3;
        }
    }
    
    @@keyframes circularSpin {
        from {
            transform: rotate(0deg);
        }
        to {
            transform: rotate(360deg);
        }
    }
    
    @@keyframes modernPulse {
        0%, 100% {
            height: 15px;
            opacity: 0.7;
        }
        50% {
            height: 35px;
            opacity: 1;
        }
    }
    
    @@keyframes slideInUp {
        from {
            transform: translateY(50px);
            opacity: 0;
        }
        to {
            transform: translateY(0);
            opacity: 1;
        }
    }
    
    @@keyframes fadeInScale {
        from {
            transform: scale(0.8);
            opacity: 0;
        }
        to {
            transform: scale(1);
            opacity: 1;
        }
    }
    
    @@keyframes fadeIn {
        from {
            opacity: 0;
        }
        to {
            opacity: 1;
        }
    }
    
    @@keyframes pulse {
        0%, 100% {
            transform: scale(1);
            opacity: 1;
        }
        50% {
            transform: scale(1.05);
            opacity: 0.8;
        }
    }
    
    @@keyframes rotate {
        from {
            transform: rotate(0deg);
        }
        to {
            transform: rotate(360deg);
        }
    }
    
    @@keyframes bounce {
        0%, 80%, 100% {
            transform: scale(0.6);
            opacity: 0.5;
        }
        40% {
            transform: scale(1);
            opacity: 1;
        }
    }
    
    @@keyframes progressLoad {
        0% {
            width: 0%;
        }
        50% {
            width: 60%;
        }
        100% {
            width: 100%;
        }
    }
    
    /* Mobile responsiveness */
    @@media (max-width: 768px) {
        .brand-text {
            font-size: 2.5rem;
        }
        
        .binflow-logo {
            width: 100px;
            height: 100px;
        }
        
        .shape-1, .shape-4 {
            width: 42px;
            height: 42px;
        }
        
        .shape-2, .shape-3 {
            width: 50px;
            height: 50px;
        }
        
        .logo-circle {
            width: 100px;
            height: 100px;
        }
        
        .logo-icon {
            font-size: 3rem;
        }
        
        .progress-container {
            width: 250px;
        }
    }
</style>

@code {
    // No C# logic needed - pure JavaScript handles the timing
}
